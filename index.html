<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <title>Formulario incidencia</title>
  </head>
  <body>
    <div class='container'>
      <h1>Bienvenido al formulario de incidencias</h1>
      
      <script>
        
        var listado;

        function onSuccess(elcurso) {
         
          listado = document.getElementById('lista');
          listado.innerHTML = elcurso;
          listado.addEventListener('change', (e) =>{
            console.log(e.target.value);

          function creaFormulario(creacion) {

            var cForm = document.getElementById('formu');
            //cForm.innerHTML = 'Formulario creado: ' + '<a href="' + creacion +'">Enlace al formulario</a>';
            //cForm.innerHTML = 'Formulario creado: ' + '<a href="'+creacion+'">enlace</a>';
            window.location.replace(creacion);

          
          }

          google.script.run.withSuccessHandler(creaFormulario).parteIncidencia(e.target.value);})
        
        }
      
      google.script.run.withSuccessHandler(onSuccess).cargarCursos();
      </script>
      <p>Lista de cursos.</p>
      <select id="lista"></select>
      <p>Seleccione curso y espere a ser redirigido al formulario</p>
      <div id='formu'></div>
    </div>
    
  </body>
</html>